<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Twitch 弾幕配信</title>
  <style>
    body {
      margin: 0;
      display: flex;
      height: 100vh;
      background: #111;
      color: white;
    }
    #video-area {
      position: relative;
      width: 75%;
      height: 100%;
      background: black;
      overflow: hidden;
    }
    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    #chat {
      width: 25%;
      height: 100%;
    }
    .danmaku {
      position: absolute;
      white-space: nowrap;
      color: white;
      font-size: 22px;
      font-weight: bold;
      text-shadow: 2px 2px 4px black;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <!-- 左：動画エリア -->
  <div id="video-area">
    <iframe
      src="https://player.twitch.tv/?channel=abc123&parent=ユーザー名.github.io"
      allowfullscreen>
    </iframe>
  </div>

  <!-- 右：公式チャット -->
  <div id="chat">
    <iframe
      src="https://www.twitch.tv/embed/abc123/chat?parent=ユーザー名.github.io">
    </iframe>
  </div>

  <!-- tmi.jsでコメント取得 -->
  <script src="https://unpkg.com/tmi.js"></script>
  <script>
    const client = new tmi.Client({
      channels: [ 'abc123' ]
    });

    client.connect();

    client.on('message', (channel, tags, message, self) => {
      createDanmaku(message);
    });

    function createDanmaku(text) {
      const span = document.createElement("span");
      span.className = "danmaku";
      span.innerText = text;
      span.style.top = Math.random() * 500 + "px";
      document.getElementById("video-area").appendChild(span);
      span.animate(
        [{ transform: "translateX(100%)" }, { transform: "translateX(-100%)" }],
        { duration: 8000, easing: "linear" }
      ).onfinish = () => span.remove();
    }
  </script>
</body>
</html>
